<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />

<style id="webmakerstyle">

</style>
</head>
<body>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Screen Share App</title>

<style>
body {
  background-color: #121212;
  color: white;
  font-family: sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.container {
  text-align: center;
  width: 90%;
  max-width: 800px;
}

video {
  width: 100%;
  border-radius: 12px;
  background-color: #000;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  margin-bottom: 20px;
}

button {
  padding: 12px 24px;
  margin: 0 10px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
}

#startBtn { background-color: #2ecc71; color: white; }
#stopBtn { background-color: #e74c3c; color: white; }
</style>
</head>

<body>
<div class="container">
  <h1>Screen Share App</h1>
  <video id="video" autoplay playsinline></video>
  <br>
  <button id="startBtn">Start Sharing</button>
  <button id="stopBtn">Stop Sharing</button>
</div>

<script>
const video = document.getElementById("video");
const startBtn = document.getElementById("startBtn");
const stopBtn = document.getElementById("stopBtn");

const ws = new WebSocket("wss://signal.openshare.dev"); // public signaling server
const pc = new RTCPeerConnection({
  iceServers: [{ urls: "stun:stun.l.google.com:19302" }]
});

let localStream;

// Send ICE candidates
pc.onicecandidate = e => {
  if (e.candidate) {
    ws.send(JSON.stringify({ type: "ice", data: e.candidate }));
  }
};

// Receive remote stream
pc.ontrack = e => {
  video.srcObject = e.streams[0];
};

ws.onmessage = async msg => {
  const data = JSON.parse(msg.data);

  if (data.type === "offer") {
    await pc.setRemoteDescription(data.data);
    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);
    ws.send(JSON.stringify({ type: "answer", data: answer }));
  }

  if (data.type === "answer") {
    await pc.setRemoteDescription(data.data);
  }

  if (data.type === "ice") {
    await pc.addIceCandidate(data.data);
  }
};

startBtn.onclick = async () => {
  localStream = await navigator.mediaDevices.getDisplayMedia({
    video: true,
    audio: true
  });

  localStream.getTracks().forEach(track =>
    pc.addTrack(track, localStream)
  );

  video.srcObject = localStream;

  const offer = await pc.createOffer();
  await pc.setLocalDescription(offer);
  ws.send(JSON.stringify({ type: "offer", data: offer }));
};

stopBtn.onclick = () => {
  if (localStream) {
    localStream.getTracks().forEach(t => t.stop());
  }
  pc.close();
};
</script>
</body>
</html>



</body>
</html>
